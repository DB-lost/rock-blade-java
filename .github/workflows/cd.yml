name: Continuous Deployment

on:
  push:
    branches: [ master ]
    tags: [ 'v*' ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Download Artifact
        uses: actions/download-artifact@v4
        with:
          name: app-package
      
      # 如果是发布版本,创建GitHub Release
      - name: Create Release
        if: startsWith(github.ref, 'refs/tags/')
        uses: softprops/action-gh-release@v1
        with:
          files: "*.jar"
          generate_release_notes: true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      # 部署到开发环境
      - name: Deploy to Dev
        if: github.ref == 'refs/heads/develop'
        run: |
          echo "部署到开发环境"
          # 这里添加你的部署脚本
      
      # 部署到生产环境
      - name: Deploy to Prod
        if: github.ref == 'refs/heads/main'
        run: |
          echo "部署到生产环境"
          # 这里添加你的部署脚本